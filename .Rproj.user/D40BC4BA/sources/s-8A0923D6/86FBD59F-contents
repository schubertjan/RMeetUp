devtools::install_github("schubertjan/ELH")
library(ELH)
library(tidyverse)
data("ELHteams")

ELHteams <- ELHteams %>%
    group_by(seasonStart) %>%
    mutate(playoff = Team %in% Team[competitionType == "PlayOff"])

ELHteams <- ELHteams %>%
    group_by(seasonStart,competitionType) %>%
    mutate(rank = rank(-B))

playoffCut <- ELHteams %>%
    group_by(seasonStart,playoff) %>%
    filter(competitionType == "RegularSeason") %>%
    summarise(Bmin = min(B,na.rm = T))
playoffCut <- playoffCut[playoffCut$playoff == TRUE,]


regularSeason <- ELHteams[ELHteams$competitionType == "RegularSeason",]

#shots
featurePlot(y=regularSeason$B,regularSeason[,5:12],plot="pairs",cex=0.5)
ggplot(data=regularSeason,aes(SFpr,B))+
    geom_smooth(method = "lm")+
    geom_jitter()
summary(lm(data=regularSeason,B~SFpr))

#corsi
featurePlot(y=regularSeason$B,regularSeason[,13:19],plot="pairs",cex=0.5)
ggplot(data=regularSeason,aes(CFpr,B))+
    geom_smooth(method = "lm")+
    geom_jitter()
summary(lm(data=regularSeason,B~CFpr))

#faceoff
featurePlot(y=regularSeason$B,regularSeason[,20:31],plot="pairs",cex=0.5)
